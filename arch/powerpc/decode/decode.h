#ifndef DECODE_PPC_H
#define DECODE_PPC_H

#include <inttypes.h>
#include <stddef.h>
#include <stdbool.h>

#define DECODE_FLAGS_PPC64      0x01
#define DECODE_FLAGS_ALTIVEC    0x02
#define DECODE_FLAGS_VSX        0x04

#ifdef __cplusplus
extern "C" {
#endif
	enum Register
	{
		NUPPC_REG_GPR0,
		NUPPC_REG_GPR1,
		NUPPC_REG_GPR2,
		NUPPC_REG_GPR3,
		NUPPC_REG_GPR4,
		NUPPC_REG_GPR5,
		NUPPC_REG_GPR6,
		NUPPC_REG_GPR7,
		NUPPC_REG_GPR8,
		NUPPC_REG_GPR9,
		NUPPC_REG_GPR10,
		NUPPC_REG_GPR11,
		NUPPC_REG_GPR12,
		NUPPC_REG_GPR13,
		NUPPC_REG_GPR14,
		NUPPC_REG_GPR15,
		NUPPC_REG_GPR16,
		NUPPC_REG_GPR17,
		NUPPC_REG_GPR18,
		NUPPC_REG_GPR19,
		NUPPC_REG_GPR20,
		NUPPC_REG_GPR21,
		NUPPC_REG_GPR22,
		NUPPC_REG_GPR23,
		NUPPC_REG_GPR24,
		NUPPC_REG_GPR25,
		NUPPC_REG_GPR26,
		NUPPC_REG_GPR27,
		NUPPC_REG_GPR28,
		NUPPC_REG_GPR29,
		NUPPC_REG_GPR30,
		NUPPC_REG_GPR31,

		NUPPC_REG_FR0,
		NUPPC_REG_FR1,
		NUPPC_REG_FR2,
		NUPPC_REG_FR3,
		NUPPC_REG_FR4,
		NUPPC_REG_FR5,
		NUPPC_REG_FR6,
		NUPPC_REG_FR7,
		NUPPC_REG_FR8,
		NUPPC_REG_FR9,
		NUPPC_REG_FR10,
		NUPPC_REG_FR11,
		NUPPC_REG_FR12,
		NUPPC_REG_FR13,
		NUPPC_REG_FR14,
		NUPPC_REG_FR15,
		NUPPC_REG_FR16,
		NUPPC_REG_FR17,
		NUPPC_REG_FR18,
		NUPPC_REG_FR19,
		NUPPC_REG_FR20,
		NUPPC_REG_FR21,
		NUPPC_REG_FR22,
		NUPPC_REG_FR23,
		NUPPC_REG_FR24,
		NUPPC_REG_FR25,
		NUPPC_REG_FR26,
		NUPPC_REG_FR27,
		NUPPC_REG_FR28,
		NUPPC_REG_FR29,
		NUPPC_REG_FR30,
		NUPPC_REG_FR31,

		// each 4-bit CR register
		NUPPC_REG_CRF0,
		NUPPC_REG_CRF1,
		NUPPC_REG_CRF2,
		NUPPC_REG_CRF3,
		NUPPC_REG_CRF4,
		NUPPC_REG_CRF5,
		NUPPC_REG_CRF6,
		NUPPC_REG_CRF7,

		// each bit in the CR register
		NUPPC_REG_CR_BIT0,
		NUPPC_REG_CR_BIT1,
		NUPPC_REG_CR_BIT2,
		NUPPC_REG_CR_BIT3,
		NUPPC_REG_CR_BIT4,
		NUPPC_REG_CR_BIT5,
		NUPPC_REG_CR_BIT6,
		NUPPC_REG_CR_BIT7,
		NUPPC_REG_CR_BIT8,
		NUPPC_REG_CR_BIT9,
		NUPPC_REG_CR_BIT10,
		NUPPC_REG_CR_BIT11,
		NUPPC_REG_CR_BIT12,
		NUPPC_REG_CR_BIT13,
		NUPPC_REG_CR_BIT14,
		NUPPC_REG_CR_BIT15,
		NUPPC_REG_CR_BIT16,
		NUPPC_REG_CR_BIT17,
		NUPPC_REG_CR_BIT18,
		NUPPC_REG_CR_BIT19,
		NUPPC_REG_CR_BIT20,
		NUPPC_REG_CR_BIT21,
		NUPPC_REG_CR_BIT22,
		NUPPC_REG_CR_BIT23,
		NUPPC_REG_CR_BIT24,
		NUPPC_REG_CR_BIT25,
		NUPPC_REG_CR_BIT26,
		NUPPC_REG_CR_BIT27,
		NUPPC_REG_CR_BIT28,
		NUPPC_REG_CR_BIT29,
		NUPPC_REG_CR_BIT30,
		NUPPC_REG_CR_BIT31,

		NUPPC_REG_AV_VR0,
		NUPPC_REG_AV_VR1,
		NUPPC_REG_AV_VR2,
		NUPPC_REG_AV_VR3,
		NUPPC_REG_AV_VR4,
		NUPPC_REG_AV_VR5,
		NUPPC_REG_AV_VR6,
		NUPPC_REG_AV_VR7,
		NUPPC_REG_AV_VR8,
		NUPPC_REG_AV_VR9,
		NUPPC_REG_AV_VR10,
		NUPPC_REG_AV_VR11,
		NUPPC_REG_AV_VR12,
		NUPPC_REG_AV_VR13,
		NUPPC_REG_AV_VR14,
		NUPPC_REG_AV_VR15,
		NUPPC_REG_AV_VR16,
		NUPPC_REG_AV_VR17,
		NUPPC_REG_AV_VR18,
		NUPPC_REG_AV_VR19,
		NUPPC_REG_AV_VR20,
		NUPPC_REG_AV_VR21,
		NUPPC_REG_AV_VR22,
		NUPPC_REG_AV_VR23,
		NUPPC_REG_AV_VR24,
		NUPPC_REG_AV_VR25,
		NUPPC_REG_AV_VR26,
		NUPPC_REG_AV_VR27,
		NUPPC_REG_AV_VR28,
		NUPPC_REG_AV_VR29,
		NUPPC_REG_AV_VR30,
		NUPPC_REG_AV_VR31,

		NUPPC_REG_VSX_VR0,
		NUPPC_REG_VSX_VR1,
		NUPPC_REG_VSX_VR2,
		NUPPC_REG_VSX_VR3,
		NUPPC_REG_VSX_VR4,
		NUPPC_REG_VSX_VR5,
		NUPPC_REG_VSX_VR6,
		NUPPC_REG_VSX_VR7,
		NUPPC_REG_VSX_VR8,
		NUPPC_REG_VSX_VR9,
		NUPPC_REG_VSX_VR10,
		NUPPC_REG_VSX_VR11,
		NUPPC_REG_VSX_VR12,
		NUPPC_REG_VSX_VR13,
		NUPPC_REG_VSX_VR14,
		NUPPC_REG_VSX_VR15,
		NUPPC_REG_VSX_VR16,
		NUPPC_REG_VSX_VR17,
		NUPPC_REG_VSX_VR18,
		NUPPC_REG_VSX_VR19,
		NUPPC_REG_VSX_VR20,
		NUPPC_REG_VSX_VR21,
		NUPPC_REG_VSX_VR22,
		NUPPC_REG_VSX_VR23,
		NUPPC_REG_VSX_VR24,
		NUPPC_REG_VSX_VR25,
		NUPPC_REG_VSX_VR26,
		NUPPC_REG_VSX_VR27,
		NUPPC_REG_VSX_VR28,
		NUPPC_REG_VSX_VR29,
		NUPPC_REG_VSX_VR30,
		NUPPC_REG_VSX_VR31,
		NUPPC_REG_VSX_VR32,
		NUPPC_REG_VSX_VR33,
		NUPPC_REG_VSX_VR34,
		NUPPC_REG_VSX_VR35,
		NUPPC_REG_VSX_VR36,
		NUPPC_REG_VSX_VR37,
		NUPPC_REG_VSX_VR38,
		NUPPC_REG_VSX_VR39,
		NUPPC_REG_VSX_VR40,
		NUPPC_REG_VSX_VR41,
		NUPPC_REG_VSX_VR42,
		NUPPC_REG_VSX_VR43,
		NUPPC_REG_VSX_VR44,
		NUPPC_REG_VSX_VR45,
		NUPPC_REG_VSX_VR46,
		NUPPC_REG_VSX_VR47,
		NUPPC_REG_VSX_VR48,
		NUPPC_REG_VSX_VR49,
		NUPPC_REG_VSX_VR50,
		NUPPC_REG_VSX_VR51,
		NUPPC_REG_VSX_VR52,
		NUPPC_REG_VSX_VR53,
		NUPPC_REG_VSX_VR54,
		NUPPC_REG_VSX_VR55,
		NUPPC_REG_VSX_VR56,
		NUPPC_REG_VSX_VR57,
		NUPPC_REG_VSX_VR58,
		NUPPC_REG_VSX_VR59,
		NUPPC_REG_VSX_VR60,
		NUPPC_REG_VSX_VR61,
		NUPPC_REG_VSX_VR62,
		NUPPC_REG_VSX_VR63,
	};

#ifndef __cplusplus
	typedef enum Register Register;
#endif

	enum OperandClass
	{
		PPC_OP_NONE = 0,
		PPC_OP_UIMM,
		PPC_OP_SIMM,
		PPC_OP_LABEL,
		PPC_OP_MEM_RA,
		PPC_OP_BI,

		PPC_OP_REG_RA,
		PPC_OP_REG_RB,
		PPC_OP_REG_RD,
		PPC_OP_REG_RS,

		PPC_OP_REG_FRA,
		PPC_OP_REG_FRB,
		PPC_OP_REG_FRC,
		PPC_OP_REG_FRD,
		PPC_OP_REG_FRS,

		PPC_OP_REG_CRFD,
		PPC_OP_REG_CRFS,
		PPC_OP_REG_CRBA,
		PPC_OP_REG_CRBB,
		PPC_OP_REG_CRBD,

		PPC_OP_REG_AV_VA,
		PPC_OP_REG_AV_VB,
		PPC_OP_REG_AV_VC,
		PPC_OP_REG_AV_VD,
		PPC_OP_REG_AV_VS,

		// DWORD0 means that only the 0th dword is affected, which
		// has an overlap with floating registers
		PPC_OP_REG_VSX_RA,
		PPC_OP_REG_VSX_RA_DWORD0,

		PPC_OP_REG_VSX_RB,
		PPC_OP_REG_VSX_RB_DWORD0,

		PPC_OP_REG_VSX_RC,
		PPC_OP_REG_VSX_RC_DWORD0,

		PPC_OP_REG_VSX_RD,
		PPC_OP_REG_VSX_RD_DWORD0,

		PPC_OP_REG_VSX_RS,
		PPC_OP_REG_VSX_RS_DWORD0,
	};

#ifndef __cplusplus
	typedef enum OperandClass OperandClass;
#endif

	enum VsxWidth
	{
		VSX_WIDTH_FULL,
		VSX_WIDTH_DWORD0,
	};

#ifndef __cplusplus
	typedef enum VsxWidth VsxWidth;
#endif

	struct MemoryOperand
	{
		enum Register reg;
		int32_t offset;
	};

#ifndef __cplusplus
	typedef struct MemoryOperand MemoryOperand;
#endif

	struct Operand
	{
		OperandClass cls;
		union {
			enum Register reg;
			uint64_t uimm;
			int64_t simm;
			MemoryOperand mem;
			uint64_t label;
		};
	};

#ifndef __cplusplus
	typedef struct Operand Operand;
#endif

	// trailing lowercase 'x' indicates potential other mnemonics (rc, oe, lk,
	// etc. bits)
	enum InstructionId
	{
		PPC_ID_INVALID,

		PPC_ID_ADDx,
		PPC_ID_ADDCx,
		PPC_ID_ADDEx,
		PPC_ID_ADDI,
		PPC_ID_ADDICx,
		PPC_ID_ADDIS,
		PPC_ID_ADDMEx,
		PPC_ID_ADDZEx,
		PPC_ID_ANDx,
		PPC_ID_ANDCx,
		PPC_ID_ANDI,
		PPC_ID_ANDIS,
		PPC_ID_ATTN,
		PPC_ID_Bx,
		PPC_ID_BCx,
		PPC_ID_BCCTRx,
		PPC_ID_BCLRx,
		PPC_ID_BCTRx,
		PPC_ID_BDZx,
		PPC_ID_BDZCTRx,
		PPC_ID_BDZLRx,
		PPC_ID_BDNZx,
		PPC_ID_BDNZCTRx,
		PPC_ID_BDNZLRx,
		PPC_ID_BDNZFx,
		PPC_ID_BDNZFCTRx,
		PPC_ID_BDNZFLRx,
		PPC_ID_BDNZTx,
		PPC_ID_BDNZTCTRx,
		PPC_ID_BDNZTLRx,
		PPC_ID_BDZFx,
		PPC_ID_BDZFCTRx,
		PPC_ID_BDZFLRx,
		PPC_ID_BDZTx,
		PPC_ID_BDZTCTRx,
		PPC_ID_BDZTLRx,
		PPC_ID_BEQx,
		PPC_ID_BEQCTRx,
		PPC_ID_BEQLRx,
		PPC_ID_BFx,
		PPC_ID_BFCTRx,
		PPC_ID_BFLRx,
		PPC_ID_BGEx,
		PPC_ID_BGECTRx,
		PPC_ID_BGELRx,
		PPC_ID_BGTx,
		PPC_ID_BGTCTRx,
		PPC_ID_BGTLRx,
		PPC_ID_BLEx,
		PPC_ID_BLECTRx,
		PPC_ID_BLELRx,
		PPC_ID_BLTx,
		PPC_ID_BLTCTRx,
		PPC_ID_BLTLRx,
		PPC_ID_BLRx,
		PPC_ID_BNEx,
		PPC_ID_BNECTRx,
		PPC_ID_BNELRx,
		PPC_ID_BNSx,
		PPC_ID_BNSCTRx,
		PPC_ID_BNSLRx,
		PPC_ID_BSOx,
		PPC_ID_BSOCTRx,
		PPC_ID_BSOLRx,
		PPC_ID_BTx,
		PPC_ID_BTCTRx,
		PPC_ID_BTLRx,
		PPC_ID_CLRLDIx,
		PPC_ID_CLRLWIx,
		PPC_ID_CLRRWIx,
		PPC_ID_CMPB,
		PPC_ID_CMPD,
		PPC_ID_CMPDI,
		PPC_ID_CMPW,
		PPC_ID_CMPWI,
		PPC_ID_CMPLD,
		PPC_ID_CMPLDI,
		PPC_ID_CMPLW,
		PPC_ID_CMPLWI,
		PPC_ID_CNTLZDx,
		PPC_ID_CNTLZWx,
		PPC_ID_CRAND,
		PPC_ID_CRANDC,
		PPC_ID_CRCLR,
		PPC_ID_CREQV,
		PPC_ID_CRMOVE,
		PPC_ID_CRNAND,
		PPC_ID_CRNOR,
		PPC_ID_CRNOT,
		PPC_ID_CROR,
		PPC_ID_CRORC,
		PPC_ID_CRSET,
		PPC_ID_CRXOR,
		PPC_ID_DCBA,
		PPC_ID_DCBF,
		PPC_ID_DCBI,
		PPC_ID_DCBST,
		PPC_ID_DCBT,
		PPC_ID_DCBTST,
		PPC_ID_DCBZ,
		PPC_ID_DCBZL,
		PPC_ID_DCCCI,
		PPC_ID_DCI,
		PPC_ID_DIVDx,
		PPC_ID_DIVDUx,
		PPC_ID_DIVWx,
		PPC_ID_DIVWUx,
		PPC_ID_ECIWX,
		PPC_ID_ECOWX,
		PPC_ID_EIEIO,
		PPC_ID_EQVx,
		PPC_ID_EXTSBx,
		PPC_ID_EXTSHx,
		PPC_ID_EXTSWx,
		PPC_ID_FABSx,
		PPC_ID_FADDx,
		PPC_ID_FADDSx,
		PPC_ID_FCFIDx,
		PPC_ID_FCFIDSx,
		PPC_ID_FCFIDUx,
		PPC_ID_FCFIDUSx,
		PPC_ID_FCMPO,
		PPC_ID_FCMPU,
		PPC_ID_FCPSGNx,
		PPC_ID_FCTIDx,
		PPC_ID_FCTIDUZx,
		PPC_ID_FCTIDZx,
		PPC_ID_FCTIWx,
		PPC_ID_FCTIWUZx,
		PPC_ID_FCTIWZx,
		PPC_ID_FDIVx,
		PPC_ID_FDIVSx,
		PPC_ID_FMADDx,
		PPC_ID_FMADDSx,
		PPC_ID_FMRx,
		PPC_ID_FMSUBx,
		PPC_ID_FMSUBSx,
		PPC_ID_FMULx,
		PPC_ID_FMULSx,
		PPC_ID_FNABSx,
		PPC_ID_FNEGx,
		PPC_ID_FNMADDx,
		PPC_ID_FNMADDSx,
		PPC_ID_FNMSUBx,
		PPC_ID_FNMSUBSx,
		PPC_ID_FREx,
		PPC_ID_FRESx,
		PPC_ID_FRIMx,
		PPC_ID_FRINx,
		PPC_ID_FRIPx,
		PPC_ID_FRIZx,
		PPC_ID_FRSPx,
		PPC_ID_FRSQRTEx,
		PPC_ID_FRSQRTESx,
		PPC_ID_FSELx,
		PPC_ID_FSQRTx,
		PPC_ID_FSQRTSx,
		PPC_ID_FSUBx,
		PPC_ID_FSUBSx,
		PPC_ID_ICBI,
		PPC_ID_ICBT,
		PPC_ID_ICCCI,
		PPC_ID_ICI,
		PPC_ID_ISEL,
		PPC_ID_ISYNC,
		PPC_ID_LBZ,
		PPC_ID_LBZCIX,
		PPC_ID_LBZU,
		PPC_ID_LBZUX,
		PPC_ID_LBZX,
		PPC_ID_LDARX,
		PPC_ID_LDBRX,
		PPC_ID_LDCIX,
		PPC_ID_LD,
		PPC_ID_LDU,
		PPC_ID_LDUX,
		PPC_ID_LDX,
		PPC_ID_LFD,
		PPC_ID_LFDU,
		PPC_ID_LFDUX,
		PPC_ID_LFDX,
		PPC_ID_LFIWAX,
		PPC_ID_LFIWZX,
		PPC_ID_LFS,
		PPC_ID_LFSU,
		PPC_ID_LFSUX,
		PPC_ID_LFSX,
		PPC_ID_LHA,
		PPC_ID_LHAU,
		PPC_ID_LHAUX,
		PPC_ID_LHAX,
		PPC_ID_LHBRX,
		PPC_ID_LHZ,
		PPC_ID_LHZCIX,
		PPC_ID_LHZU,
		PPC_ID_LHZUX,
		PPC_ID_LHZX,
		PPC_ID_LI,
		PPC_ID_LIS,
		PPC_ID_LMW,
		PPC_ID_LSWI,
		PPC_ID_LSWX,
		PPC_ID_LWA,
		PPC_ID_LWAX,
		PPC_ID_LWARX,
		PPC_ID_LWAUX,
		PPC_ID_LWBRX,
		PPC_ID_LWSYNC,
		PPC_ID_LWZ,
		PPC_ID_LWZCIX,
		PPC_ID_LWZU,
		PPC_ID_LWZUX,
		PPC_ID_LWZX,
		PPC_ID_MBAR,
		PPC_ID_MCRF,
		PPC_ID_MCRFS,
		PPC_ID_MCRXR,
		PPC_ID_MFBR0,
		PPC_ID_MFBR1,
		PPC_ID_MFBR2,
		PPC_ID_MFBR3,
		PPC_ID_MFBR4,
		PPC_ID_MFBR5,
		PPC_ID_MFBR6,
		PPC_ID_MFBR7,
		PPC_ID_MFCR,
		PPC_ID_MFCTR,
		PPC_ID_MFDCR,
		PPC_ID_MFDCRUX,
		PPC_ID_MFDCRX,
		PPC_ID_MFFSx,
		PPC_ID_MFLR,
		PPC_ID_MFMSR,
		PPC_ID_MFOCRF,
		PPC_ID_MFSPR,
		PPC_ID_MFSR,
		PPC_ID_MFSRIN,
		PPC_ID_MFTB,
		PPC_ID_MFTBU,
		PPC_ID_MFXER,
		PPC_ID_MRx,
		PPC_ID_MTAMR,
		PPC_ID_MTBR0,
		PPC_ID_MTBR1,
		PPC_ID_MTBR2,
		PPC_ID_MTBR3,
		PPC_ID_MTBR4,
		PPC_ID_MTBR5,
		PPC_ID_MTBR6,
		PPC_ID_MTBR7,
		PPC_ID_MTCFAR,
		PPC_ID_MTCRF,
		PPC_ID_MTCTR,
		PPC_ID_MTDAR,
		PPC_ID_MTDCCR,
		PPC_ID_MTDCR,
		PPC_ID_MTDCRUX,
		PPC_ID_MTDCRX,
		PPC_ID_MTFSB0x,
		PPC_ID_MTFSB1x,
		PPC_ID_MTFSFx,
		PPC_ID_MTFSFIx,
		PPC_ID_MTICCR,
		PPC_ID_MTLR,
		PPC_ID_MTMSR,
		PPC_ID_MTMSRD,
		PPC_ID_MTOCRF,
		PPC_ID_MTSPR,
		PPC_ID_MTSR,
		PPC_ID_MTSRIN,
		PPC_ID_MTSRR2,
		PPC_ID_MTSRR3,
		PPC_ID_MTTBHI,
		PPC_ID_MTTBL,
		PPC_ID_MTTBU,
		PPC_ID_MTXER,
		PPC_ID_MULHDx,
		PPC_ID_MULHDUx,
		PPC_ID_MULHWx,
		PPC_ID_MULHWUx,
		PPC_ID_MULLDx,
		PPC_ID_MULLI,
		PPC_ID_MULLWx,
		PPC_ID_NANDx,
		PPC_ID_NEGx,
		PPC_ID_NOP,
		PPC_ID_NORx,
		PPC_ID_ORx,
		PPC_ID_ORCx,
		PPC_ID_ORI,
		PPC_ID_ORIS,
		PPC_ID_POPCNTB,
		PPC_ID_POPCNTD,
		PPC_ID_POPCNTW,
		PPC_ID_PTESYNC,
		PPC_ID_RFCI,
		PPC_ID_RFDI,
		PPC_ID_RFI,
		PPC_ID_RFID,
		PPC_ID_RFMCI,
		PPC_ID_RLDICLx,
		PPC_ID_RLDICRx,
		PPC_ID_RLDICx,
		PPC_ID_RLDIMIx,
		PPC_ID_RLDCLx,
		PPC_ID_RLDCRx,
		PPC_ID_RLWIMIx,
		PPC_ID_RLWINMx,
		PPC_ID_RLWNMx,
		PPC_ID_ROTLDx,
		PPC_ID_ROTLDIx,
		PPC_ID_ROTLWx,
		PPC_ID_ROTLWIx,
		PPC_ID_SC,
		PPC_ID_SLBIA,
		PPC_ID_SLBIE,
		PPC_ID_SLBMFEE,
		PPC_ID_SLBMTE,
		PPC_ID_SLDx,
		PPC_ID_SLDIx,
		PPC_ID_SLWx,
		PPC_ID_SLWIx,
		PPC_ID_SRADx,
		PPC_ID_SRADIx,
		PPC_ID_SRAWx,
		PPC_ID_SRAWIx,
		PPC_ID_SRDx,
		PPC_ID_SRDIx,
		PPC_ID_SRWx,
		PPC_ID_SRWIx,
		PPC_ID_STB,
		PPC_ID_STBU,
		PPC_ID_STBUX,
		PPC_ID_STBX,
		PPC_ID_STBCIX,
		PPC_ID_STD,
		PPC_ID_STDBRX,
		PPC_ID_STDCIX,
		PPC_ID_STDCX,
		PPC_ID_STDU,
		PPC_ID_STDUX,
		PPC_ID_STDX,
		PPC_ID_STFD,
		PPC_ID_STFDU,
		PPC_ID_STFDUX,
		PPC_ID_STFDX,
		PPC_ID_STFIWX,
		PPC_ID_STFS,
		PPC_ID_STFSU,
		PPC_ID_STFSUX,
		PPC_ID_STFSX,
		PPC_ID_STH,
		PPC_ID_STHBRX,
		PPC_ID_STHCIX,
		PPC_ID_STHU,
		PPC_ID_STHUX,
		PPC_ID_STHX,
		PPC_ID_STMW,
		PPC_ID_STSWI,
		PPC_ID_STSWX,
		PPC_ID_STW,
		PPC_ID_STWBRX,
		PPC_ID_STWCIX,
		PPC_ID_STWCX,
		PPC_ID_STWU,
		PPC_ID_STWUX,
		PPC_ID_STWX,
		PPC_ID_SUBFx,
		PPC_ID_SUBFCx,
		PPC_ID_SUBFEx,
		PPC_ID_SUBFIC,
		PPC_ID_SUBFMEx,
		PPC_ID_SUBFZEx,
		PPC_ID_SYNC,
		PPC_ID_TD,
		PPC_ID_TDEQ,
		PPC_ID_TDEQI,
		PPC_ID_TDGT,
		PPC_ID_TDGTI,
		PPC_ID_TDI,
		PPC_ID_TDLGT,
		PPC_ID_TDLGTI,
		PPC_ID_TDLLT,
		PPC_ID_TDLLTI,
		PPC_ID_TDLT,
		PPC_ID_TDLTI,
		PPC_ID_TDNE,
		PPC_ID_TDNEI,
		PPC_ID_TDU,
		PPC_ID_TDUI,
		PPC_ID_TLBIA,
		PPC_ID_TLBIE,
		PPC_ID_TLBIEL,
		PPC_ID_TLBIVAX,
		PPC_ID_TLBLI,
		PPC_ID_TLBSX,
		PPC_ID_TLBSYNC,
		PPC_ID_TLBRE,
		PPC_ID_TLBRELO,
		PPC_ID_TLBREHI,
		PPC_ID_TLBWE,
		PPC_ID_TLBWEHI,
		PPC_ID_TLBWELO,
		PPC_ID_TW,
		PPC_ID_TWEQ,
		PPC_ID_TWEQI,
		PPC_ID_TWGT,
		PPC_ID_TWGTI,
		PPC_ID_TWGEI,
		PPC_ID_TWI,
		PPC_ID_TWLEI,
		PPC_ID_TWLLEI,
		PPC_ID_TWLGT,
		PPC_ID_TWLGTI,
		PPC_ID_TWLLT,
		PPC_ID_TWLLTI,
		PPC_ID_TWLT,
		PPC_ID_TWLTI,
		PPC_ID_TWNE,
		PPC_ID_TWNEI,
		PPC_ID_TWU,
		PPC_ID_TWUI,
		PPC_ID_WAIT,
		PPC_ID_WAITIMPL,
		PPC_ID_WAITRSV,
		PPC_ID_WRTEE,
		PPC_ID_WRTEEI,
		PPC_ID_XNOP,
		PPC_ID_XORx,
		PPC_ID_XORI,
		PPC_ID_XORIS,

		// AltiVec instructions
		PPC_ID_AV_DSS,
		PPC_ID_AV_DSSALL,
		PPC_ID_AV_DST,
		PPC_ID_AV_DSTST,
		PPC_ID_AV_DSTSTT,
		PPC_ID_AV_DSTT,
		PPC_ID_AV_LVEBX,
		PPC_ID_AV_LVEHX,
		PPC_ID_AV_LVEWX,
		PPC_ID_AV_LVSL,
		PPC_ID_AV_LVSR,
		PPC_ID_AV_LVX,
		PPC_ID_AV_LVXL,
		PPC_ID_AV_MFVSCR,
		PPC_ID_AV_MTVSCR,
		PPC_ID_AV_STVEBX,
		PPC_ID_AV_STVEHX,
		PPC_ID_AV_STVEWX,
		PPC_ID_AV_STVX,
		PPC_ID_AV_STVXL,
		PPC_ID_AV_VADDCUW,
		PPC_ID_AV_VADDFP,
		PPC_ID_AV_VADDSBS,
		PPC_ID_AV_VADDSHS,
		PPC_ID_AV_VADDSWS,
		PPC_ID_AV_VADDUBM,
		PPC_ID_AV_VADDUBS,
		PPC_ID_AV_VADDUDM,
		PPC_ID_AV_VADDUHM,
		PPC_ID_AV_VADDUHS,
		PPC_ID_AV_VADDUWM,
		PPC_ID_AV_VADDUWS,
		PPC_ID_AV_VAND,
		PPC_ID_AV_VANDC,
		PPC_ID_AV_VAVGSB,
		PPC_ID_AV_VAVGSH,
		PPC_ID_AV_VAVGSW,
		PPC_ID_AV_VAVGUB,
		PPC_ID_AV_VAVGUH,
		PPC_ID_AV_VAVGUW,
		PPC_ID_AV_VCFSX,
		PPC_ID_AV_VCFUX,
		PPC_ID_AV_VCLZB,
		PPC_ID_AV_VCLZD,
		PPC_ID_AV_VCLZH,
		PPC_ID_AV_VCLZW,
		PPC_ID_AV_VCMPBFPx,
		PPC_ID_AV_VCMPEQFPx,
		PPC_ID_AV_VCMPEQUBx,
		PPC_ID_AV_VCMPEQUDx,
		PPC_ID_AV_VCMPEQUHx,
		PPC_ID_AV_VCMPEQUWx,
		PPC_ID_AV_VCMPGEFPx,
		PPC_ID_AV_VCMPGTFPx,
		PPC_ID_AV_VCMPGTSBx,
		PPC_ID_AV_VCMPGTSDx,
		PPC_ID_AV_VCMPGTSHx,
		PPC_ID_AV_VCMPGTSWx,
		PPC_ID_AV_VCMPGTUBx,
		PPC_ID_AV_VCMPGTUDx,
		PPC_ID_AV_VCMPGTUHx,
		PPC_ID_AV_VCMPGTUWx,
		PPC_ID_AV_VCTSXS,
		PPC_ID_AV_VCTUXS,
		PPC_ID_AV_VEQV,
		PPC_ID_AV_VEXPTEFP,
		PPC_ID_AV_VLOGEFP,
		PPC_ID_AV_VMADDFP,
		PPC_ID_AV_VMAXFP,
		PPC_ID_AV_VMAXSB,
		PPC_ID_AV_VMAXSD,
		PPC_ID_AV_VMAXSH,
		PPC_ID_AV_VMAXSW,
		PPC_ID_AV_VMAXUB,
		PPC_ID_AV_VMAXUD,
		PPC_ID_AV_VMAXUH,
		PPC_ID_AV_VMAXUW,
		PPC_ID_AV_VMHADDSHS,
		PPC_ID_AV_VMHRADDSHS,
		PPC_ID_AV_VMINFP,
		PPC_ID_AV_VMINSB,
		PPC_ID_AV_VMINSD,
		PPC_ID_AV_VMINSH,
		PPC_ID_AV_VMINSW,
		PPC_ID_AV_VMINUB,
		PPC_ID_AV_VMINUD,
		PPC_ID_AV_VMINUH,
		PPC_ID_AV_VMINUW,
		PPC_ID_AV_VMLADDUHM,
		PPC_ID_AV_VMRGHB,
		PPC_ID_AV_VMRGHH,
		PPC_ID_AV_VMRGHW,
		PPC_ID_AV_VMRGLB,
		PPC_ID_AV_VMRGLH,
		PPC_ID_AV_VMRGLW,
		PPC_ID_AV_VMSUMMBM,
		PPC_ID_AV_VMSUMSHM,
		PPC_ID_AV_VMSUMSHS,
		PPC_ID_AV_VMSUMUBM,
		PPC_ID_AV_VMSUMUHM,
		PPC_ID_AV_VMSUMUHS,
		PPC_ID_AV_VMULESB,
		PPC_ID_AV_VMULESH,
		PPC_ID_AV_VMULESW,
		PPC_ID_AV_VMULEUB,
		PPC_ID_AV_VMULEUH,
		PPC_ID_AV_VMULEUW,
		PPC_ID_AV_VMULOSB,
		PPC_ID_AV_VMULOSH,
		PPC_ID_AV_VMULOSW,
		PPC_ID_AV_VMULOUB,
		PPC_ID_AV_VMULOUH,
		PPC_ID_AV_VMULOUW,
		PPC_ID_AV_VMULUWM,
		PPC_ID_AV_VNAND,
		PPC_ID_AV_VNMSUBFP,
		PPC_ID_AV_VNOR,
		PPC_ID_AV_VOR,
		PPC_ID_AV_VORC,
		PPC_ID_AV_VPERM,
		PPC_ID_AV_VPKPX,
		PPC_ID_AV_VPKSHSS,
		PPC_ID_AV_VPKSHUS,
		PPC_ID_AV_VPKSWSS,
		PPC_ID_AV_VPKSWUS,
		PPC_ID_AV_VPKUHUM,
		PPC_ID_AV_VPKUHUS,
		PPC_ID_AV_VPKUWUM,
		PPC_ID_AV_VPKUWUS,
		PPC_ID_AV_VPOPCNTB,
		PPC_ID_AV_VPOPCNTD,
		PPC_ID_AV_VPOPCNTH,
		PPC_ID_AV_VPOPCNTW,
		PPC_ID_AV_VREFP,
		PPC_ID_AV_VRFIM,
		PPC_ID_AV_VRFIN,
		PPC_ID_AV_VRFIP,
		PPC_ID_AV_VRFIZ,
		PPC_ID_AV_VRLB,
		PPC_ID_AV_VRLD,
		PPC_ID_AV_VRLH,
		PPC_ID_AV_VRLW,
		PPC_ID_AV_VRSQRTEFP,
		PPC_ID_AV_VSEL,
		PPC_ID_AV_VSL,
		PPC_ID_AV_VSLB,
		PPC_ID_AV_VSLD,
		PPC_ID_AV_VSLDOI,
		PPC_ID_AV_VSLH,
		PPC_ID_AV_VSLO,
		PPC_ID_AV_VSLW,
		PPC_ID_AV_VSPLTB,
		PPC_ID_AV_VSPLTH,
		PPC_ID_AV_VSPLTISB,
		PPC_ID_AV_VSPLTISH,
		PPC_ID_AV_VSPLTISW,
		PPC_ID_AV_VSPLTW,
		PPC_ID_AV_VSR,
		PPC_ID_AV_VSRAB,
		PPC_ID_AV_VSRAD,
		PPC_ID_AV_VSRAH,
		PPC_ID_AV_VSRAW,
		PPC_ID_AV_VSRB,
		PPC_ID_AV_VSRD,
		PPC_ID_AV_VSRH,
		PPC_ID_AV_VSRO,
		PPC_ID_AV_VSRW,
		PPC_ID_AV_VSUBCUW,
		PPC_ID_AV_VSUBFP,
		PPC_ID_AV_VSUBSBS,
		PPC_ID_AV_VSUBSHS,
		PPC_ID_AV_VSUBSWS,
		PPC_ID_AV_VSUBUBM,
		PPC_ID_AV_VSUBUBS,
		PPC_ID_AV_VSUBUDM,
		PPC_ID_AV_VSUBUHM,
		PPC_ID_AV_VSUBUHS,
		PPC_ID_AV_VSUBUWM,
		PPC_ID_AV_VSUBUWS,
		PPC_ID_AV_VSUMSWS,
		PPC_ID_AV_VSUM2SWS,
		PPC_ID_AV_VSUM4SBS,
		PPC_ID_AV_VSUM4SHS,
		PPC_ID_AV_VSUM4UBS,
		PPC_ID_AV_VUPKHPX,
		PPC_ID_AV_VUPKHSB,
		PPC_ID_AV_VUPKHSH,
		PPC_ID_AV_VUPKLPX,
		PPC_ID_AV_VUPKLSB,
		PPC_ID_AV_VUPKLSH,
		PPC_ID_AV_VXOR,

		// VSX instructions
		PPC_ID_VSX_LXSDX,
		PPC_ID_VSX_LXSIWAX,
		PPC_ID_VSX_LXSIWZX,
		PPC_ID_VSX_LXSSPX,
		PPC_ID_VSX_LXVD2X,
		PPC_ID_VSX_LXVDSX,
		PPC_ID_VSX_LXVW4X,
		PPC_ID_VSX_STXSDX,
		PPC_ID_VSX_STXSIWX,
		PPC_ID_VSX_STXSSPX,
		PPC_ID_VSX_STXVD2X,
		PPC_ID_VSX_STXVW4X,
		PPC_ID_VSX_XSABSDP,
		PPC_ID_VSX_XSADDDP,
		PPC_ID_VSX_XSADDSP,
		PPC_ID_VSX_XSCMPODP,
		PPC_ID_VSX_XSCMPUDP,
		PPC_ID_VSX_XSCPSGNDP,
		PPC_ID_VSX_XSCVDPSP,
		PPC_ID_VSX_XSCVDPSXDS,
		PPC_ID_VSX_XSCVDPSXWS,
		PPC_ID_VSX_XSCVDPUXDS,
		PPC_ID_VSX_XSCVDPUXWS,
		PPC_ID_VSX_XSCVSPDP,
		PPC_ID_VSX_XSCVSPDPN,
		PPC_ID_VSX_XSCVSXDDP,
		PPC_ID_VSX_XSCVSXDSP,
		PPC_ID_VSX_XSCVUXDDP,
		PPC_ID_VSX_XSCVUXDSP,
		PPC_ID_VSX_XSDIVDP,
		PPC_ID_VSX_XSDIVSP,
		PPC_ID_VSX_XSMADDADP,
		PPC_ID_VSX_XSMADDASP,
		PPC_ID_VSX_XSMADDMDP,
		PPC_ID_VSX_XSMADDMSP,
		PPC_ID_VSX_XSMAXDP,
		PPC_ID_VSX_XSMINDP,
		PPC_ID_VSX_XSMSUBADP,
		PPC_ID_VSX_XSMSUBASP,
		PPC_ID_VSX_XSMSUBMDP,
		PPC_ID_VSX_XSMSUBMSP,
		PPC_ID_VSX_XSMULDP,
		PPC_ID_VSX_XSMULSP,
		PPC_ID_VSX_XSNABSDP,
		PPC_ID_VSX_XSNEGDP,
		PPC_ID_VSX_XSNMADDADP,
		PPC_ID_VSX_XSNMADDASP,
		PPC_ID_VSX_XSNMADDMDP,
		PPC_ID_VSX_XSNMADDMSP,
		PPC_ID_VSX_XSNMSUBADP,
		PPC_ID_VSX_XSNMSUBASP,
		PPC_ID_VSX_XSNMSUBMDP,
		PPC_ID_VSX_XSNMSUBMSP,
		PPC_ID_VSX_XSRDPI,
		PPC_ID_VSX_XSRDPIC,
		PPC_ID_VSX_XSRDPIM,
		PPC_ID_VSX_XSRDPIP,
		PPC_ID_VSX_XSRDPIZ,
		PPC_ID_VSX_XSREDP,
		PPC_ID_VSX_XSRESP,
		PPC_ID_VSX_XSRSQRTEDP,
		PPC_ID_VSX_XSRSQRTESP,
		PPC_ID_VSX_XSSQRTDP,
		PPC_ID_VSX_XSSQRTSP,
		PPC_ID_VSX_XSSUBDP,
		PPC_ID_VSX_XSSUBSP,
		PPC_ID_VSX_XSTDIVDP,
		PPC_ID_VSX_XSTDIVSP,
		PPC_ID_VSX_XSTSQRTDP,
		PPC_ID_VSX_XVABSDP,
		PPC_ID_VSX_XVABSSP,
		PPC_ID_VSX_XVADDDP,
		PPC_ID_VSX_XVADDSP,
		PPC_ID_VSX_XVCMPEQDPx,
		PPC_ID_VSX_XVCMPEQSPx,
		PPC_ID_VSX_XVCMPGEDPx,
		PPC_ID_VSX_XVCMPGESPx,
		PPC_ID_VSX_XVCMPGTDPx,
		PPC_ID_VSX_XVCMPGTSPx,
		PPC_ID_VSX_XVCPSGNDP,
		PPC_ID_VSX_XVCPSGNSP,
		PPC_ID_VSX_XVCVDPSP,
		PPC_ID_VSX_XVCVDPSXDS,
		PPC_ID_VSX_XVCVDPSXWS,
		PPC_ID_VSX_XVCVDPUXDS,
		PPC_ID_VSX_XVCVDPUXWS,
		PPC_ID_VSX_XVCVSPDP,
		PPC_ID_VSX_XVCVSPSXDS,
		PPC_ID_VSX_XVCVSPSXWS,
		PPC_ID_VSX_XVCVSPUXDS,
		PPC_ID_VSX_XVCVSPUXWS,
		PPC_ID_VSX_XVCVSXDDP,
		PPC_ID_VSX_XVCVSXDSP,
		PPC_ID_VSX_XVCVSXWDP,
		PPC_ID_VSX_XVCVSXWSP,
		PPC_ID_VSX_XVCVUXDDP,
		PPC_ID_VSX_XVCVUXDSP,
		PPC_ID_VSX_XVCVUXWDP,
		PPC_ID_VSX_XVCVUXWSP,
		PPC_ID_VSX_XVDIVDP,
		PPC_ID_VSX_XVDIVSP,
		PPC_ID_VSX_XVMADDADP,
		PPC_ID_VSX_XVMADDASP,
		PPC_ID_VSX_XVMADDMDP,
		PPC_ID_VSX_XVMADDMSP,
		PPC_ID_VSX_XVMAXDP,
		PPC_ID_VSX_XVMAXSP,
		PPC_ID_VSX_XVMINDP,
		PPC_ID_VSX_XVMINSP,
		PPC_ID_VSX_XVMOVDP,
		PPC_ID_VSX_XVMOVSP,
		PPC_ID_VSX_XVMSUBADP,
		PPC_ID_VSX_XVMSUBASP,
		PPC_ID_VSX_XVMSUBMDP,
		PPC_ID_VSX_XVMSUBMSP,
		PPC_ID_VSX_XVMULDP,
		PPC_ID_VSX_XVMULSP,
		PPC_ID_VSX_XVNABSDP,
		PPC_ID_VSX_XVNABSSP,
		PPC_ID_VSX_XVNMADDADP,
		PPC_ID_VSX_XVNMADDASP,
		PPC_ID_VSX_XVNMADDMDP,
		PPC_ID_VSX_XVNMADDMSP,
		PPC_ID_VSX_XVNEGDP,
		PPC_ID_VSX_XVNEGSP,
		PPC_ID_VSX_XVNMSUBADP,
		PPC_ID_VSX_XVNMSUBASP,
		PPC_ID_VSX_XVNMSUBMDP,
		PPC_ID_VSX_XVNMSUBMSP,
		PPC_ID_VSX_XVRDPI,
		PPC_ID_VSX_XVRDPIC,
		PPC_ID_VSX_XVRDPIM,
		PPC_ID_VSX_XVRDPIP,
		PPC_ID_VSX_XVRDPIZ,
		PPC_ID_VSX_XVREDP,
		PPC_ID_VSX_XVRESP,
		PPC_ID_VSX_XVRSPI,
		PPC_ID_VSX_XVRSPIC,
		PPC_ID_VSX_XVRSPIM,
		PPC_ID_VSX_XVRSPIP,
		PPC_ID_VSX_XVRSPIZ,
		PPC_ID_VSX_XVRSQRTEDP,
		PPC_ID_VSX_XVRSQRTESP,
		PPC_ID_VSX_XVSQRTDP,
		PPC_ID_VSX_XVSQRTSP,
		PPC_ID_VSX_XVSUBDP,
		PPC_ID_VSX_XVSUBSP,
		PPC_ID_VSX_XVTDIVDP,
		PPC_ID_VSX_XVTDIVSP,
		PPC_ID_VSX_XVTSQRTDP,
		PPC_ID_VSX_XVTSQRTSP,
		PPC_ID_VSX_XXLAND,
		PPC_ID_VSX_XXLANDC,
		PPC_ID_VSX_XXLEQV,
		PPC_ID_VSX_XXLNAND,
		PPC_ID_VSX_XXLNOR,
		PPC_ID_VSX_XXLOR,
		PPC_ID_VSX_XXLORC,
		PPC_ID_VSX_XXLXOR,
		PPC_ID_VSX_XXMRGHD,
		PPC_ID_VSX_XXMRGHW,
		PPC_ID_VSX_XXMRGLD,
		PPC_ID_VSX_XXMRGLW,
		PPC_ID_VSX_XXPERMDI,
		PPC_ID_VSX_XXSEL,
		PPC_ID_VSX_XXSLDWI,
		PPC_ID_VSX_XXSPLTD,
		PPC_ID_VSX_XXSPLTW,
		PPC_ID_VSX_XXSWAPD,
	};

#ifndef __cplusplus
	typedef enum InstructionId InstructionId;
#endif

	struct Instruction
	{
		InstructionId id;

		// these acronyms are from the documentation; sometimes they
		// refer to the same bit (like RC and LK)
		struct {
			uint32_t rc: 1;
			uint32_t oe: 1;
			uint32_t lk: 1;
			uint32_t aa: 1;
			uint32_t branchLikelyHint: 2;
		} flags;

		size_t numOperands;
		Operand operands[8];
	};

#ifndef __cplusplus
	typedef struct Instruction Instruction;
#endif

	bool Decompose(Instruction* instruction, uint32_t word32, uint64_t address, uint32_t flags);
	const char* GetMnemonic(const Instruction* instruction);

#ifdef __cplusplus
}
#endif


#endif // DECODE_PPC_H
